# 通用通知系统使用文档

## 📋 概述

通用通知系统是一个基于 Vue 3 的现代化通知组件，为整个网站提供统一、美观的通知体验。系统采用暗色主题设计，与网站整体风格保持一致。

## 🎯 特性

- **统一的暗色主题**：与网站整体风格完美匹配
- **多种通知类型**：支持成功、错误、警告、信息四种类型
- **优雅的动画效果**：滑入滑出动画，提升用户体验
- **自动关闭功能**：可设置持续时间，支持手动关闭
- **进度条显示**：显示自动关闭的倒计时
- **响应式设计**：在移动设备上也能良好显示
- **全局管理**：通过服务类统一管理所有通知

## 🏗️ 系统架构

### 核心组件

1. **Notification.vue** - 单个通知组件
2. **NotificationManager.vue** - 通知管理器组件
3. **notification.js** - 通知服务类

### 文件结构

```
frontend/src/
├── components/
│   ├── Notification.vue          # 单个通知组件
│   └── NotificationManager.vue   # 通知管理器
├── utils/
│   └── notification.js           # 通知服务类
└── App.vue                       # 全局注册通知管理器
```

## 🚀 快速开始

### 1. 导入通知服务

```javascript
import notificationService from '@/utils/notification.js'
```

### 2. 基本使用

```javascript
// 成功通知
notificationService.success('操作成功！')

// 错误通知
notificationService.error('操作失败，请重试')

// 警告通知
notificationService.warning('请输入有效的数据')

// 信息通知
notificationService.info('这是一条提示信息')
```

### 3. 高级用法

```javascript
// 自定义持续时间（毫秒）
notificationService.success('操作成功！', { duration: 5000 })

// 禁用自动关闭
notificationService.error('重要错误信息', { autoClose: false })

// 使用通用 show 方法
notificationService.show('自定义消息', 'success', { duration: 3000 })
```

## 📚 API 参考

### NotificationService 类

#### 方法列表

| 方法 | 参数 | 返回值 | 描述 |
|------|------|--------|------|
| `success(message, options)` | message: string, options: object | number | 显示成功通知 |
| `error(message, options)` | message: string, options: object | number | 显示错误通知 |
| `warning(message, options)` | message: string, options: object | number | 显示警告通知 |
| `info(message, options)` | message: string, options: object | number | 显示信息通知 |
| `show(message, type, options)` | message: string, type: string, options: object | number | 显示指定类型通知 |
| `clear()` | 无 | void | 清除所有通知 |

#### 参数说明

**message (string)**

- 通知消息内容
- 支持 HTML 标签（谨慎使用）

**type (string)**

- 通知类型：`'success'` | `'error'` | `'warning'` | `'info'`
- 默认为 `'info'`

**options (object)**

- `duration`: 自动关闭时间（毫秒），默认 3000
- `autoClose`: 是否自动关闭，默认 true

## 💡 使用示例

### 1. 表单验证

```javascript
// 表单提交验证
const submitForm = async () => {
  if (!formData.username) {
    notificationService.warning('请输入用户名')
    return
  }
  
  if (!formData.email) {
    notificationService.warning('请输入邮箱地址')
    return
  }
  
  try {
    await api.submitForm(formData)
    notificationService.success('表单提交成功！')
  } catch (error) {
    notificationService.error('提交失败：' + error.message)
  }
}
```

### 2. API 请求处理

```javascript
// API 请求响应处理
const fetchData = async () => {
  try {
    const response = await fetch('/api/data')
    const result = await response.json()
    
    if (result.success) {
      notificationService.success('数据加载成功')
      return result.data
    } else {
      notificationService.error('数据加载失败：' + result.message)
    }
  } catch (error) {
    notificationService.error('网络请求失败，请检查网络连接')
  }
}
```

### 3. 文件操作

```javascript
// 文件上传
const uploadFile = async (file) => {
  if (!file) {
    notificationService.warning('请选择要上传的文件')
    return
  }
  
  if (file.size > 10 * 1024 * 1024) {
    notificationService.warning('文件大小不能超过 10MB')
    return
  }
  
  try {
    const formData = new FormData()
    formData.append('file', file)
    
    const response = await fetch('/api/upload', {
      method: 'POST',
      body: formData
    })
    
    if (response.ok) {
      notificationService.success('文件上传成功！')
    } else {
      notificationService.error('文件上传失败')
    }
  } catch (error) {
    notificationService.error('上传过程中发生错误')
  }
}
```

### 4. 用户操作确认

```javascript
// 删除确认
const deleteItem = async (item) => {
  if (window.confirm(`确定要删除 "${item.name}" 吗？`)) {
    try {
      await api.deleteItem(item.id)
      notificationService.success('删除成功')
      // 刷新列表
      fetchItems()
    } catch (error) {
      notificationService.error('删除失败：' + error.message)
    }
  }
}
```

### 5. 批量操作

```javascript
// 批量删除
const batchDelete = async (items) => {
  if (items.length === 0) {
    notificationService.warning('请选择要删除的项目')
    return
  }
  
  if (!window.confirm(`确定要删除选中的 ${items.length} 个项目吗？`)) {
    return
  }
  
  try {
    const promises = items.map(item => api.deleteItem(item.id))
    await Promise.all(promises)
    notificationService.success(`成功删除 ${items.length} 个项目`)
    fetchItems()
  } catch (error) {
    notificationService.error('批量删除失败：' + error.message)
  }
}
```

## 🎨 样式定制

### 通知类型样式

```css
/* 成功通知 - 绿色主题 */
.notification-success {
  border-color: rgba(34, 197, 94, 0.3);
}

/* 错误通知 - 红色主题 */
.notification-error {
  border-color: rgba(239, 68, 68, 0.3);
}

/* 警告通知 - 黄色主题 */
.notification-warning {
  border-color: rgba(245, 158, 11, 0.3);
}

/* 信息通知 - 蓝色主题 */
.notification-info {
  border-color: rgba(0, 255, 255, 0.3);
}
```

### 自定义样式

如需自定义通知样式，可以修改 `Notification.vue` 组件中的 CSS：

```css
.notification {
  /* 自定义背景 */
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  
  /* 自定义边框 */
  border: 1px solid rgba(0, 255, 255, 0.3);
  
  /* 自定义阴影 */
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  
  /* 自定义模糊效果 */
  backdrop-filter: blur(10px);
}
```

## 🔧 配置选项

### 全局配置

在 `App.vue` 中配置通知管理器：

```vue
<template>
  <div id="app">
    <!-- 应用内容 -->
    <router-view />
    
    <!-- 通知管理器 -->
    <NotificationManager ref="notificationManager" />
  </div>
</template>

<script>
import { ref, onMounted } from 'vue'
import NotificationManager from './components/NotificationManager.vue'
import notificationService from './utils/notification.js'

export default {
  name: 'App',
  components: {
    NotificationManager
  },
  setup() {
    const notificationManager = ref(null)
    
    onMounted(() => {
      // 设置通知管理器
      notificationService.setManager(notificationManager.value)
    })
    
    return {
      notificationManager
    }
  }
}
</script>
```

### 默认配置

```javascript
// 默认配置
const defaultConfig = {
  duration: 3000,        // 默认持续时间 3 秒
  autoClose: true,       // 默认自动关闭
  maxNotifications: 5,   // 最大通知数量
  position: 'top-right'  // 显示位置
}
```

## 📱 响应式设计

通知系统在不同设备上的表现：

### 桌面端

- 通知显示在右上角
- 最小宽度 300px，最大宽度 500px
- 支持悬停效果

### 移动端

- 通知占满屏幕宽度（左右各留 10px 边距）
- 自动调整字体大小
- 优化触摸交互

## 🚨 最佳实践

### 1. 消息内容

```javascript
// ✅ 好的做法
notificationService.success('用户注册成功')
notificationService.error('网络连接失败，请检查网络设置')
notificationService.warning('密码长度至少需要 8 位字符')

// ❌ 避免的做法
notificationService.success('OK')
notificationService.error('Error')
notificationService.warning('Warning')
```

### 2. 错误处理

```javascript
// ✅ 完整的错误处理
try {
  const result = await apiCall()
  notificationService.success('操作成功')
} catch (error) {
  console.error('API 调用失败:', error)
  
  if (error.code === 'NETWORK_ERROR') {
    notificationService.error('网络连接失败，请检查网络设置')
  } else if (error.code === 'VALIDATION_ERROR') {
    notificationService.warning('输入数据格式不正确')
  } else {
    notificationService.error('操作失败，请稍后重试')
  }
}
```

### 3. 性能优化

```javascript
// ✅ 避免频繁通知
let lastNotificationTime = 0
const NOTIFICATION_COOLDOWN = 1000 // 1秒冷却时间

const showNotification = (message, type) => {
  const now = Date.now()
  if (now - lastNotificationTime < NOTIFICATION_COOLDOWN) {
    return
  }
  
  lastNotificationTime = now
  notificationService[type](message)
}
```

### 4. 国际化支持

```javascript
// ✅ 支持多语言
const t = (key) => i18n.t(key)

notificationService.success(t('messages.success'))
notificationService.error(t('messages.error'))
notificationService.warning(t('messages.warning'))
```

## 🐛 故障排除

### 常见问题

#### 1. 通知不显示

**问题**：调用通知方法后没有显示通知

**解决方案**：

```javascript
// 检查通知管理器是否已初始化
if (!notificationService.manager) {
  console.error('通知管理器未初始化')
  // 确保在 App.vue 中正确设置了管理器
}
```

#### 2. 样式不生效

**问题**：通知样式与预期不符

**解决方案**：

- 检查 CSS 是否正确加载
- 确认没有其他样式覆盖
- 验证 Vue 组件是否正确渲染

#### 3. 通知重叠

**问题**：多个通知重叠显示

**解决方案**：

```javascript
// 清除之前的通知
notificationService.clear()
notificationService.success('新通知')
```

### 调试技巧

```javascript
// 启用调试模式
const DEBUG = process.env.NODE_ENV === 'development'

if (DEBUG) {
  console.log('通知服务状态:', {
    manager: !!notificationService.manager,
    notifications: notificationService.manager?.notifications?.length || 0
  })
}
```

## 📈 扩展功能

### 1. 自定义通知类型

```javascript
// 扩展通知类型
notificationService.custom = (message, options = {}) => {
  return notificationService.show(message, 'custom', {
    ...options,
    icon: '🎉',
    color: '#ff6b6b'
  })
}
```

### 2. 通知持久化

```javascript
// 持久化重要通知
notificationService.persistent = (message, type = 'info') => {
  return notificationService.show(message, type, {
    autoClose: false,
    persistent: true
  })
}
```

### 3. 通知队列

```javascript
// 通知队列管理
class NotificationQueue {
  constructor() {
    this.queue = []
    this.processing = false
  }
  
  add(message, type, options) {
    this.queue.push({ message, type, options })
    this.process()
  }
  
  async process() {
    if (this.processing || this.queue.length === 0) return
    
    this.processing = true
    const notification = this.queue.shift()
    
    notificationService.show(notification.message, notification.type, notification.options)
    
    // 等待通知显示完成
    await new Promise(resolve => setTimeout(resolve, 1000))
    
    this.processing = false
    this.process()
  }
}
```

## 📄 更新日志

### v1.0.0 (2025-01-12)

- ✨ 初始版本发布
- 🎨 暗色主题设计
- 📱 响应式支持
- 🔧 完整的 API 接口
- 📚 详细的使用文档

## 🤝 贡献指南

如果您想为通知系统贡献代码，请遵循以下步骤：

1. Fork 项目
2. 创建功能分支
3. 提交更改
4. 推送到分支
5. 创建 Pull Request

## 📞 支持

如果您在使用过程中遇到问题，请：

1. 查看本文档的故障排除部分
2. 检查项目的 Issues 页面
3. 创建新的 Issue 描述问题

---

**注意**：本通知系统专为暗色主题设计，如需适配其他主题，请相应调整 CSS 样式。
